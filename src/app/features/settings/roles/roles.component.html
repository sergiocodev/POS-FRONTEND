<app-confirm-modal></app-confirm-modal>
<app-modal-alert></app-modal-alert>
<app-module-header title="Roles y Permisos" iconClass="bi bi-shield-lock"></app-module-header>

<div class="roles-page animate-fade-in">

    <!-- Tabla de roles -->
    <app-roles-list [roles]="roles()" [isLoading]="isLoading()" (create)="onOpenForm()" (edit)="onOpenForm($event)"
        (permissions)="onOpenPermissions($event)" (delete)="onDeleteRole($event)"
        (toggleStatus)="onToggleStatus($event)">
    </app-roles-list>

    <!-- Modal de Formulario de Rol -->
    <app-modal-generic [title]="selectedRoleId() ? 'Editar Rol' : 'Nuevo Rol'" [isVisible]="showRoleForm()"
        (close)="onFormCancelled()">
        <app-role-form *ngIf="showRoleForm()" [roleId]="selectedRoleId()" (saved)="onFormSaved()"
            (cancelled)="onFormCancelled()">
        </app-role-form>
    </app-modal-generic>

    <!-- Modal de Permisos de Rol -->
    <app-modal-generic title="Gestionar Permisos" [isVisible]="showPermissionsModal()"
        (close)="onPermissionsCancelled()" size="xl">
        <app-role-permissions *ngIf="showPermissionsModal() && selectedRoleForPermissions()"
            [roleId]="selectedRoleForPermissions()!.id" [roleName]="selectedRoleForPermissions()!.name"
            (saved)="onPermissionsSaved()" (cancelled)="onPermissionsCancelled()">
        </app-role-permissions>
    </app-modal-generic>

</div>
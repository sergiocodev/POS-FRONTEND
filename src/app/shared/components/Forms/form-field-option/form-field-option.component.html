<div class="form-field-container mb-3" [formGroup]="formGroup">
    <label class="form-label fw-bold text-dark small mb-2" *ngIf="label" [for]="formControlName">
        {{ label }} <span class="text-danger" *ngIf="required">*</span>
    </label>

    <ng-container [ngSwitch]="type">
        <!-- TEXT / EMAIL / NUMBER / DATE -->
        <input *ngSwitchCase="'text'" type="text" class="form-control" [id]="formControlName" [value]="control.value"
            (input)="onInput($event)" (blur)="onBlur()" [placeholder]="placeholder" [attr.maxLength]="maxLength"
            [attr.minLength]="minLength" [ngClass]="{ 'is-invalid': showError, 'is-valid': isValid }" />

        <input *ngSwitchCase="'email'" type="email" class="form-control" [id]="formControlName" [value]="control.value"
            (input)="onInput($event)" (blur)="onBlur()" [placeholder]="placeholder"
            [ngClass]="{ 'is-invalid': showError, 'is-valid': isValid }" />

        <input *ngSwitchCase="'number'" type="number" class="form-control" [id]="formControlName"
            [value]="control.value" (input)="onInput($event)" (blur)="onBlur()" [placeholder]="placeholder"
            [ngClass]="{ 'is-invalid': showError, 'is-valid': isValid }" />

        <input *ngSwitchCase="'date'" type="date" class="form-control" [id]="formControlName"
            [value]="control.value || today" (input)="onInput($event)" (blur)="onBlur()"
            [ngClass]="{ 'is-invalid': showError, 'is-valid': isValid }" />

        <!-- SELECT -->
        <select *ngSwitchCase="'select'" class="form-select" [formControlName]="formControlName" [id]="formControlName"
            (change)="onInput($event)" (blur)="onBlur()"
            [ngClass]="required || hasValue() ? { 'is-invalid': showError, 'is-valid': isValid } : {}">
            <option value="" disabled selected>{{ placeholder || 'Seleccione...' }}</option>
            <option *ngFor="let opt of options" [value]="opt.id || opt.value || opt">
                {{ opt.name || opt.label || opt.text || opt }}
            </option>
        </select>

        <!-- TEXTAREA -->
        <textarea *ngSwitchCase="'textarea'" class="form-control" [id]="formControlName" [value]="control.value"
            (input)="onInput($event)" (blur)="onBlur()" [placeholder]="placeholder" [attr.maxLength]="maxLength"
            [attr.minLength]="minLength" [ngClass]="{ 'is-invalid': showError, 'is-valid': isValid }"></textarea>
    </ng-container>

    <!-- Validation Messages -->
    <div class="errors-area mt-1 min-h-20">
        <div *ngIf="showError" class="text-danger animate-slide-up">
            <small *ngIf="control.errors?.['required']" class="error-text">
                <i class="bi bi-x-circle me-1"></i> {{ label || 'Este campo' }} es requerido
            </small>
            <small *ngIf="control.errors?.['minlength']" class="error-text">
                <i class="bi bi-x-circle me-1"></i> Mínimo {{ minLength }} caracteres
            </small>
            <small *ngIf="control.errors?.['maxlength']" class="error-text">
                <i class="bi bi-x-circle me-1"></i> Máximo {{ maxLength }} caracteres
            </small>
            <small *ngIf="control.errors?.['email']" class="error-text">
                <i class="bi bi-x-circle me-1"></i> Formato de correo inválido
            </small>
        </div>
    </div>
</div>